 

             
    <table class='table table-bordered table-triable white'>
        <thead>
            <tr>
                {%  if activate_finess %}
                <th>FINESS</th>
                {% endif %}
                <th>Nom</th>
                {% if gestionnaire is not defined %}
                    <th>Gestionnaire</th>
                {% endif %}
                {% if ReferentielPublic is not defined %}
                
                    <th>Referentiel</th>
                {% endif %}
                <th>Questions Répondues</th>
                <th>Critères notés</th>
                <th title='Nb Objectifs Stratégiques'>Nb. OSA</th>
                <th title='Nb Objectifs opérationnels'>Nb. OOA</th>
                <th title='Nb Objectifs opérationnels'>Bibliotheque</th>
                <th>Usage disque </th>
                <th>Espace disque </th>

                <th>Sauvegardes</th>
                <th title="Nombre d'utilisateurs"><i class="glyphicon glyphicon-user"></th>
            </tr>
        </thead>
        
        
        <tbody>
        {% for etablissement in etablissements  %}
            {% if  etablissement.users | length == 0 %}
            <tr class='alert-danger'>
            {% else %}
            <tr>
            {% endif %}
                {%  if activate_finess %}
                <td>{{ etablissement.codefiness }}</td>
                {% endif %}
                                  
                {% if etablissement.category.reel %}
                    <td  class='alert alert-info' title='{{ etablissement.category.commentaire}}'> <a href="{{ path('backoffice_etablissement_view', { 'id': etablissement.id }) }}">{{ etablissement.nom }}</a></td>
                {% else %}
                    <td  class='alert alert-warning' title='{{ etablissement.category.commentaire}}'> <a href="{{ path('backoffice_etablissement_view', { 'id': etablissement.id }) }}">{{ etablissement.nom }}</a></td>
                {% endif %}

                {% if gestionnaire is not defined %}
                    {% if etablissement.gestionnaire is not null %}
                        <td class='small'><a href="{{ path('backoffice_gestionnaire_show', { 'id': etablissement.gestionnaire.id }) }}">{{ etablissement.gestionnaire }}</a></td>
                    {% else %}
                        <td></td>
                    {% endif %}
                {% endif %}
 
                {% if ReferentielPublic is not defined %}
                     {% if etablissement.referentielPublic.obsolete %}
                            <td title='! Le référentiel est obsolete' class='small alert-danger' title='{{etablissement.public}}'>{{etablissement.referentielPublic.short}} ({{etablissement.referentielPublic.year}})</td>
                    {% elseif etablissement.referentielPublic.EnDev %}
                            <td title='! Le référentiel est en cours de développement' class='small alert-warning' title='{{etablissement.public}}'>{{etablissement.referentielPublic.short}} ({{etablissement.referentielPublic.year}})</td>
                    {% else %}
                            <td  title='Le référentiel est fini et en production' class='small alert-success' title='{{etablissement.public}}'>{{etablissement.referentielPublic.short}} ({{etablissement.referentielPublic.year}})</td>
                    {% endif %}
                {% endif %}
                
                    <td>{{ etablissement.NbQuestionsReponduesCache | progressBarNotCent(etablissement.NbQuestions)  | raw}} </td>
                    <td>{{ etablissement.NbCriteresNotesCache | progressBarNotCent( etablissement.getNbCriteres)  | raw}}  </td>
                    <td>{{ etablissement.NbObjectifsSrategique}}  </td>
                    <td>{{ etablissement.NbObjectifsOperationnel}}  </td>
                    <td>{{ etablissement.NbBibliotheques}}  </td>
 
                    
                    
                    {# 
                       {% set SizeTotalFileUploadCache = etablissement | sizeTotalFileUpload   %}
                       #}
                       {% set SizeTotalFileUploadCache = etablissement.SizeTotalFileUploadCache %}

                        
                    {% if etablissement.sizeMaxUpload  <   SizeTotalFileUploadCache %}
                        <td title='{{SizeTotalFileUploadCache | formatBytes}} sur  {{etablissement.sizeMaxUpload | formatBytes}} autorisés).' class='alert alert-danger'>    
                    {% else %}
                        <td title='{{SizeTotalFileUploadCache | formatBytes}} sur  {{etablissement.sizeMaxUpload | formatBytes}} autorisés).' class='alert alert-success'>    
                    {% endif %}
                        
                        {{SizeTotalFileUploadCache | sizeFileUpladBar(etablissement.sizeMaxUpload ) | raw }}
                    </td>
                    <td>{{etablissement.sizeMaxUpload | formatBytes}} </td>

                    {% include "Synthese/Sauvegardes/inc_td_sauvegarde.html.twig" with {'link_save' : true} %} 
                    
                    
                    {% if  etablissement.users | length == 0 %}
                        <td title="L établissement doit avoir au moins 1 utilisateur !! ">{{ etablissement.users | length}}  - <i class='glyphicon glyphicon-warning-sign'></td>
                    {% else %}
                        <td>{{ etablissement.users | length}}</td>
                    {% endif %}
            </tr>
        {% endfor %}
        </tbody>
    </table>